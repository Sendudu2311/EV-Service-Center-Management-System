<mxfile host="Electron" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/28.0.4 Chrome/138.0.7204.97 Electron/37.2.1 Safari/537.36" version="28.0.4">
  <diagram id="UML-Class-Diagram" name="UML Standard Class Diagram">
    <mxGraphModel dx="2646" dy="1886" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1654" pageHeight="2339" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="pkg-core" value="«package»&lt;br&gt;&lt;b&gt;Core Domain&lt;/b&gt;" style="shape=folder;fontStyle=1;tabWidth=110;tabHeight=30;tabPosition=left;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;verticalAlign=top;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="40" y="40" width="620" height="480" as="geometry" />
        </mxCell>
        <mxCell id="user" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;&lt;b&gt;User&lt;/b&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ email: String {unique}&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;- password: String&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ firstName: String&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ lastName: String&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ phone: String&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ role: RoleEnum&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ isActive: Boolean&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ specializations: String[0..*]&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ matchPassword(pwd: String): Boolean&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ getFullName(): String&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="60" y="100" width="260" height="220" as="geometry" />
        </mxCell>
        <mxCell id="vehicle" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;&lt;b&gt;Vehicle&lt;/b&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ vin: String [1] {unique}&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ make: String [1]&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ model: String [1]&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ year: int [1]&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ batteryType: BatteryTypeEnum&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ batteryCapacity: decimal&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ mileage: int&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ calculateNextMaintenance(): Date&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ isMaintenanceDue(): Boolean&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="360" y="100" width="280" height="200" as="geometry" />
        </mxCell>
        <mxCell id="appointment" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;&lt;b&gt;Appointment&lt;/b&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ appointmentNumber: String [1] {unique}&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ scheduledDate: Date [1]&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ scheduledTime: String [1]&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ status: AppointmentStatusEnum&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ coreStatus: CoreStatusEnum&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ totalAmount: decimal&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ paymentStatus: PaymentStatusEnum&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ calculateTotal(): decimal&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ canTransitionTo(status: String): Boolean&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ updateStatus(status: String): void&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ requestCancellation(reason: String): void&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="60" y="360" width="300" height="240" as="geometry" />
        </mxCell>
        <mxCell id="pkg-service" value="«package»&lt;br&gt;&lt;b&gt;Service Management&lt;/b&gt;" style="shape=folder;fontStyle=1;tabWidth=140;tabHeight=30;tabPosition=left;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;verticalAlign=top;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="700" y="40" width="900" height="600" as="geometry" />
        </mxCell>
        <mxCell id="serviceReception" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;&lt;b&gt;ServiceReception&lt;/b&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ receptionNumber: String [1] {unique}&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ receivedAt: Date [1]&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ status: ReceptionStatusEnum&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ vehicleCondition: VehicleCondition&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ estimatedCompletionTime: Date&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ hasExternalParts: Boolean&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ submitToStaff(techId: Identifier): void&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ staffReview(decision: String): void&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ canBeApproved(): Boolean&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ getEstimatedCost(): decimal&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="720" y="100" width="320" height="240" as="geometry" />
        </mxCell>
        <mxCell id="evChecklist" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;&lt;b&gt;EVChecklist&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;(Template)&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ code: String [1] {unique}&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ name: String [1]&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ category: CategoryEnum&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ estimatedDuration: int&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ isActive: Boolean&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ createInstance(aptId: Identifier): ChecklistInstance&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ isApplicableToVehicle(vehicle: Vehicle): Boolean&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="1160" y="100" width="380" height="180" as="geometry" />
        </mxCell>
        <mxCell id="checklistInstance" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;&lt;b&gt;ChecklistInstance&lt;/b&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ status: InstanceStatusEnum&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ startedAt: Date [0..1]&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ completedAt: Date [0..1]&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ progressPercentage: int&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ overallResult: ResultEnum&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ startChecklist(techId: Identifier): void&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ completeItem(stepNo: int, result: String): void&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ calculateQualityScore(): int&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="1190" y="360" width="320" height="200" as="geometry" />
        </mxCell>
        <mxCell id="service" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;&lt;b&gt;Service&lt;/b&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ code: String [1] {unique}&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ name: String [1]&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ category: ServiceCategoryEnum&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ basePrice: decimal [1]&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ estimatedDuration: int [1]&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ isActive: Boolean&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="720" y="380" width="280" height="150" as="geometry" />
        </mxCell>
        <mxCell id="pkg-parts" value="«package»&lt;br&gt;&lt;b&gt;Parts Management&lt;/b&gt;" style="shape=folder;fontStyle=1;tabWidth=140;tabHeight=30;tabPosition=left;html=1;fillColor=#f8cecc;strokeColor=#b85450;align=left;verticalAlign=top;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="40" y="660" width="860" height="560" as="geometry" />
        </mxCell>
        <mxCell id="part" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;&lt;b&gt;Part&lt;/b&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ partNumber: String [1] {unique}&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ name: String [1]&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ category: PartCategoryEnum&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ brand: String [1]&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ pricing: Pricing&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ inventory: Inventory&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ isActive: Boolean&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ getAvailableStock(): int&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ needsReorder(): Boolean&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ calculateDynamicReorderPoint(): int&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="60" y="720" width="320" height="240" as="geometry" />
        </mxCell>
        <mxCell id="partRequest" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;&lt;b&gt;PartRequest&lt;/b&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ requestNumber: String [1] {unique}&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ type: RequestTypeEnum&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ status: RequestStatusEnum&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ urgency: UrgencyEnum&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ estimatedCost: decimal&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ calculateEstimatedCost(): decimal&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ checkPartsAvailability(): Object&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ approve(staffId: Identifier, decision: String): void&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="440" y="720" width="340" height="200" as="geometry" />
        </mxCell>
        <mxCell id="partConflict" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;&lt;b&gt;PartConflict&lt;/b&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ conflictNumber: String [1] {unique}&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ availableStock: int&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ totalRequested: int&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ shortfall: int&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ status: ConflictStatusEnum&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ resolve(staffId: Identifier, notes: String): void&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;{static} + generateConflictNumber(): String&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="420" y="960" width="340" height="180" as="geometry" />
        </mxCell>
        <mxCell id="pkg-financial" value="«package»&lt;br&gt;&lt;b&gt;Financial&lt;/b&gt;" style="shape=folder;fontStyle=1;tabWidth=110;tabHeight=30;tabPosition=left;html=1;fillColor=#d5e8d4;strokeColor=#82b366;align=left;verticalAlign=top;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="940" y="660" width="660" height="560" as="geometry" />
        </mxCell>
        <mxCell id="invoice" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;&lt;b&gt;Invoice&lt;/b&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ invoiceNumber: String [1] {unique}&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ status: InvoiceStatusEnum&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ totals: InvoiceTotals&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ paymentInfo: PaymentInfo&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ sentToCustomer: Boolean&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ calculateTotals(): InvoiceTotals&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ recordPayment(data: Object): void&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ sendToCustomer(method: String): void&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ isOverdue(): Boolean&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="960" y="720" width="300" height="220" as="geometry" />
        </mxCell>
        <mxCell id="transaction" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;&lt;b&gt;Transaction&lt;/b&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ transactionRef: String [1] {unique}&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ transactionType: PaymentMethodEnum&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ paymentPurpose: PurposeEnum&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ amount: decimal [1]&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ status: TransactionStatusEnum&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ currency: String = &quot;VND&quot;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ updateStatus(status: String): void&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ handleFailure(code: String, msg: String): void&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ isExpired(): Boolean&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;{static} + getStatistics(range: Object): Object&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1300" y="720" width="280" height="260" as="geometry" />
        </mxCell>
        <mxCell id="rel-user-vehicle" value="" style="endArrow=none;html=1;endSize=12;edgeStyle=orthogonalEdgeStyle;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0.003;entryY=0.293;entryDx=0;entryDy=0;strokeWidth=2;entryPerimeter=0;" parent="1" source="user" target="vehicle" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="320" y="150" as="sourcePoint" />
            <mxPoint x="360" y="150" as="targetPoint" />
            <Array as="points">
              <mxPoint x="360" y="155" />
              <mxPoint x="360" y="159" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-user-vehicle-label1" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-user-vehicle" vertex="1" connectable="0">
          <mxGeometry x="-0.85" relative="1" as="geometry">
            <mxPoint x="-5" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-user-vehicle-label2" value="0..*" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-user-vehicle" vertex="1" connectable="0">
          <mxGeometry x="0.85" relative="1" as="geometry">
            <mxPoint x="-10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-user-vehicle-role" value="owns" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=11;fontStyle=2" parent="rel-user-vehicle" vertex="1" connectable="0">
          <mxGeometry x="0.1" relative="1" as="geometry">
            <mxPoint y="12" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-user-appointment" value="" style="endArrow=none;html=1;endSize=12;edgeStyle=orthogonalEdgeStyle;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;strokeWidth=2;" parent="1" source="user" target="appointment" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="190" y="330" />
              <mxPoint x="50" y="330" />
              <mxPoint x="50" y="420" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-user-apt-label1" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-user-appointment" vertex="1" connectable="0">
          <mxGeometry x="-0.85" relative="1" as="geometry">
            <mxPoint x="10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-user-apt-label2" value="0..*" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-user-appointment" vertex="1" connectable="0">
          <mxGeometry x="0.85" relative="1" as="geometry">
            <mxPoint x="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-user-apt-role" value="books" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=11;fontStyle=2" parent="rel-user-appointment" vertex="1" connectable="0">
          <mxGeometry x="0.3" relative="1" as="geometry">
            <mxPoint x="15" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-vehicle-apt" value="" style="endArrow=none;html=1;endSize=12;edgeStyle=orthogonalEdgeStyle;exitX=0.383;exitY=0.994;exitDx=0;exitDy=0;entryX=1;entryY=0.25;entryDx=0;entryDy=0;strokeWidth=2;exitPerimeter=0;" parent="1" source="vehicle" target="appointment" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-vehicle-apt-label1" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-vehicle-apt" vertex="1" connectable="0">
          <mxGeometry x="-0.85" relative="1" as="geometry">
            <mxPoint x="10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-vehicle-apt-label2" value="0..*" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-vehicle-apt" vertex="1" connectable="0">
          <mxGeometry x="0.85" relative="1" as="geometry">
            <mxPoint x="-10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-tech-apt" value="" style="endArrow=none;html=1;endSize=12;exitX=0.25;exitY=1;exitDx=0;exitDy=0;strokeWidth=2;" parent="1" source="user" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="125" y="360" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-tech-apt-label1" value="0..1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-tech-apt" vertex="1" connectable="0">
          <mxGeometry x="-0.85" relative="1" as="geometry">
            <mxPoint x="15" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-tech-apt-label2" value="0..*" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-tech-apt" vertex="1" connectable="0">
          <mxGeometry x="0.85" relative="1" as="geometry">
            <mxPoint x="15" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-tech-apt-role" value="assignedTechnician" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontStyle=2" parent="rel-tech-apt" vertex="1" connectable="0">
          <mxGeometry x="0.2" relative="1" as="geometry">
            <mxPoint x="35" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-apt-reception" value="" style="endArrow=none;html=1;endSize=12;startArrow=diamondThin;startSize=20;startFill=1;edgeStyle=orthogonalEdgeStyle;exitX=0.99;exitY=0.396;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;strokeWidth=2;exitPerimeter=0;" parent="1" source="appointment" target="serviceReception" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="540" y="455" />
              <mxPoint x="540" y="330" />
              <mxPoint x="680" y="330" />
              <mxPoint x="680" y="160" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-apt-reception-label1" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-apt-reception" vertex="1" connectable="0">
          <mxGeometry x="-0.85" relative="1" as="geometry">
            <mxPoint x="-10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-apt-reception-label2" value="0..1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-apt-reception" vertex="1" connectable="0">
          <mxGeometry x="0.85" relative="1" as="geometry">
            <mxPoint x="10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-apt-reception-role" value="creates" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=11;fontStyle=2" parent="rel-apt-reception" vertex="1" connectable="0">
          <mxGeometry x="0.1" relative="1" as="geometry">
            <mxPoint y="12" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-checklist-instance" value="" style="endArrow=open;html=1;endSize=12;dashed=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;" parent="1" source="evChecklist" target="checklistInstance" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-checklist-instance-label" value="«instantiate»" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontStyle=2" parent="rel-checklist-instance" vertex="1" connectable="0">
          <mxGeometry x="0.1" relative="1" as="geometry">
            <mxPoint x="35" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-reception-instance" value="" style="endArrow=none;html=1;endSize=12;edgeStyle=orthogonalEdgeStyle;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;" parent="1" source="serviceReception" target="checklistInstance" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-reception-instance-label1" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-reception-instance" vertex="1" connectable="0">
          <mxGeometry x="-0.85" relative="1" as="geometry">
            <mxPoint x="-10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-reception-instance-label2" value="0..1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-reception-instance" vertex="1" connectable="0">
          <mxGeometry x="0.85" relative="1" as="geometry">
            <mxPoint x="10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-reception-partreq" value="" style="endArrow=none;html=1;endSize=12;edgeStyle=orthogonalEdgeStyle;entryX=1;entryY=0.25;entryDx=0;entryDy=0;strokeWidth=2;" parent="1" target="partRequest" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1020" y="340" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="1020" y="580" />
              <mxPoint x="810" y="580" />
              <mxPoint x="810" y="770" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-reception-partreq-label1" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-reception-partreq" vertex="1" connectable="0">
          <mxGeometry x="-0.9" relative="1" as="geometry">
            <mxPoint x="-10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-reception-partreq-label2" value="0..*" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-reception-partreq" vertex="1" connectable="0">
          <mxGeometry x="0.9" relative="1" as="geometry">
            <mxPoint x="10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-reception-partreq-role" value="requests" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=11;fontStyle=2" parent="rel-reception-partreq" vertex="1" connectable="0">
          <mxGeometry x="0.1" relative="1" as="geometry">
            <mxPoint y="12" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-partreq-part" value="" style="endArrow=none;html=1;endSize=12;edgeStyle=orthogonalEdgeStyle;exitX=0;exitY=0.75;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;" parent="1" source="partRequest" target="part" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-partreq-part-label1" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-partreq-part" vertex="1" connectable="0">
          <mxGeometry x="-0.9" relative="1" as="geometry">
            <mxPoint x="10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-partreq-part-label2" value="1..*" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-partreq-part" vertex="1" connectable="0">
          <mxGeometry x="0.9" relative="1" as="geometry">
            <mxPoint x="-10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-partreq-part-role" value="requestedParts" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontStyle=2" parent="rel-partreq-part" vertex="1" connectable="0">
          <mxGeometry x="0.2" relative="1" as="geometry">
            <mxPoint y="12" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-part-conflict" value="" style="endArrow=none;html=1;endSize=12;edgeStyle=orthogonalEdgeStyle;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;strokeWidth=2;" parent="1" source="part" target="partConflict" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-part-conflict-label1" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-part-conflict" vertex="1" connectable="0">
          <mxGeometry x="-0.85" relative="1" as="geometry">
            <mxPoint x="10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-part-conflict-label2" value="0..*" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-part-conflict" vertex="1" connectable="0">
          <mxGeometry x="0.85" relative="1" as="geometry">
            <mxPoint x="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-apt-invoice" value="" style="endArrow=none;html=1;endSize=12;startArrow=diamondThin;startSize=20;startFill=1;edgeStyle=orthogonalEdgeStyle;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;strokeWidth=2;" parent="1" source="appointment" target="invoice" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="285" y="680" />
              <mxPoint x="900" y="680" />
              <mxPoint x="900" y="775" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-apt-invoice-label1" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-apt-invoice" vertex="1" connectable="0">
          <mxGeometry x="-0.95" relative="1" as="geometry">
            <mxPoint x="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-apt-invoice-label2" value="0..1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-apt-invoice" vertex="1" connectable="0">
          <mxGeometry x="0.95" relative="1" as="geometry">
            <mxPoint x="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-apt-invoice-role" value="generates" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=11;fontStyle=2" parent="rel-apt-invoice" vertex="1" connectable="0">
          <mxGeometry x="-0.5" relative="1" as="geometry">
            <mxPoint y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-invoice-transaction" value="" style="endArrow=none;html=1;endSize=12;edgeStyle=orthogonalEdgeStyle;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;" parent="1" source="invoice" target="transaction" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-invoice-trans-label1" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-invoice-transaction" vertex="1" connectable="0">
          <mxGeometry x="-0.85" relative="1" as="geometry">
            <mxPoint x="-10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-invoice-trans-label2" value="0..*" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-invoice-transaction" vertex="1" connectable="0">
          <mxGeometry x="0.85" relative="1" as="geometry">
            <mxPoint x="10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-invoice-trans-role" value="records" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=11;fontStyle=2" parent="rel-invoice-transaction" vertex="1" connectable="0">
          <mxGeometry x="0.1" relative="1" as="geometry">
            <mxPoint y="12" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-apt-transaction" value="" style="endArrow=none;html=1;endSize=12;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;" parent="1" source="appointment" target="transaction" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="360" y="650" />
              <mxPoint x="620" y="650" />
              <mxPoint x="870" y="650" />
              <mxPoint x="1010" y="650" />
              <mxPoint x="1120" y="650" />
              <mxPoint x="1370" y="650" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-apt-trans-label1" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-apt-transaction" vertex="1" connectable="0">
          <mxGeometry x="-0.95" relative="1" as="geometry">
            <mxPoint x="10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-apt-trans-label2" value="0..*" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontStyle=1" parent="rel-apt-transaction" vertex="1" connectable="0">
          <mxGeometry x="0.95" relative="1" as="geometry">
            <mxPoint x="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="appointmentService" value="&lt;p style=&quot;margin:0px;margin-top:4px;text-align:center;&quot;&gt;&lt;b&gt;AppointmentService&lt;/b&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ qty: int&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ unitPrice: decimal&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ discount: decimal&lt;/p&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ lineTotal: decimal {derived}&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin:0px;margin-left:4px;&quot;&gt;+ calculateLineTotal(): decimal&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=11;fontFamily=Helvetica;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="420" y="490" width="240" height="130" as="geometry" />
        </mxCell>
        <mxCell id="rel-apt-aptSvc" value="" style="endArrow=none;html=1;endSize=12;edgeStyle=orthogonalEdgeStyle;strokeWidth=2;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="appointment" target="appointmentService" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="370" y="480" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-apt-aptSvc-l1" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;fontSize=12;fontStyle=1" parent="rel-apt-aptSvc" vertex="1" connectable="0">
          <mxGeometry x="-0.9" relative="1" as="geometry">
            <mxPoint x="-10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-apt-aptSvc-l2" value="0..*" style="edgeLabel;html=1;align=center;verticalAlign=middle;fontSize=12;fontStyle=1" parent="rel-apt-aptSvc" vertex="1" connectable="0">
          <mxGeometry x="0.9" relative="1" as="geometry">
            <mxPoint x="10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-svc-aptSvc" value="" style="endArrow=none;html=1;endSize=12;edgeStyle=orthogonalEdgeStyle;strokeWidth=2;" parent="1" source="service" target="appointmentService" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-svc-aptSvc-l1" value="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;fontSize=12;fontStyle=1" parent="rel-svc-aptSvc" vertex="1" connectable="0">
          <mxGeometry x="-0.9" relative="1" as="geometry">
            <mxPoint x="-10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-svc-aptSvc-l2" value="0..*" style="edgeLabel;html=1;align=center;verticalAlign=middle;fontSize=12;fontStyle=1" parent="rel-svc-aptSvc" vertex="1" connectable="0">
          <mxGeometry x="0.9" relative="1" as="geometry">
            <mxPoint x="10" y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-7" value="Customer" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};participant=umlActor;verticalAlign=bottom;labelPosition=center;verticalLabelPosition=top;align=center;size=65;" vertex="1" parent="1">
          <mxGeometry x="60" y="1240" width="35" height="5773" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-8" value="BookingPage" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;" vertex="1" parent="1">
          <mxGeometry x="362" y="1240" width="150" height="5773" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-9" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-8">
          <mxGeometry x="70" y="213" width="10" height="270" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-10" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-8">
          <mxGeometry x="70" y="527" width="10" height="856" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-11" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-8">
          <mxGeometry x="70" y="2510" width="10" height="1735" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-12" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-8">
          <mxGeometry x="70" y="5010" width="10" height="54" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-13" value="AppointmentService" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;" vertex="1" parent="1">
          <mxGeometry x="665" y="1240" width="164" height="5773" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-14" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-13">
          <mxGeometry x="77" y="2618" width="10" height="1563" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-15" value="VNPayController" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;" vertex="1" parent="1">
          <mxGeometry x="1118" y="1240" width="150" height="5773" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-16" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-15">
          <mxGeometry x="70" y="581" width="10" height="738" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-17" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-15">
          <mxGeometry x="70" y="1688" width="10" height="768" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-18" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-15">
          <mxGeometry x="70" y="4368" width="10" height="588" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-19" value="TransactionService" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;" vertex="1" parent="1">
          <mxGeometry x="1630" y="1240" width="150" height="5773" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-20" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-19">
          <mxGeometry x="70" y="757" width="10" height="292" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-21" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-19">
          <mxGeometry x="70" y="2096" width="10" height="296" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-22" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-19">
          <mxGeometry x="70" y="3518" width="10" height="164" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-23" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-19">
          <mxGeometry x="70" y="4614" width="10" height="278" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-24" value="VNPayGateway" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;" vertex="1" parent="1">
          <mxGeometry x="2013" y="1240" width="150" height="5773" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-25" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-24">
          <mxGeometry x="70" y="1373" width="10" height="64" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-26" value="Database" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;" vertex="1" parent="1">
          <mxGeometry x="2213" y="1240" width="150" height="5773" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-27" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-26">
          <mxGeometry x="70" y="811" width="10" height="34" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-28" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-26">
          <mxGeometry x="70" y="1988" width="10" height="44" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-29" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-26">
          <mxGeometry x="70" y="2172" width="10" height="34" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-30" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-26">
          <mxGeometry x="70" y="2853" width="10" height="34" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-31" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-26">
          <mxGeometry x="70" y="3196" width="10" height="248" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-32" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-26">
          <mxGeometry x="70" y="3594" width="10" height="24" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-33" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-26">
          <mxGeometry x="70" y="4083" width="10" height="34" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-34" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-26">
          <mxGeometry x="70" y="4506" width="10" height="44" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-35" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-26">
          <mxGeometry x="70" y="4690" width="10" height="138" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-36" value="EmailService" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;" vertex="1" parent="1">
          <mxGeometry x="2773" y="1240" width="150" height="5773" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-37" value="" style="points=[];perimeter=orthogonalPerimeter;outlineConnect=0;targetShapes=umlLifeline;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0}" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-36">
          <mxGeometry x="70" y="3803" width="10" height="174" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-38" value="par" style="shape=umlFrame;dashed=1;pointerEvents=0;dropTarget=0;strokeColor=#B3B3B3;height=20;width=30" vertex="1" parent="1">
          <mxGeometry x="124" y="4962" width="3228" height="295" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-39" value="[Send email confirmation]" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-38">
          <mxGeometry x="30" width="3198" height="20" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-40" value="alt" style="shape=umlFrame;dashed=1;pointerEvents=0;dropTarget=0;strokeColor=#B3B3B3;height=20;width=30" vertex="1" parent="1">
          <mxGeometry x="50" y="2825" width="3312" height="3603" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-41" value="[Payment Success [vnp_ResponseCode == &quot;00&quot;]]" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-40">
          <mxGeometry x="30" width="3282" height="20" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-42" value="[Payment Failed [vnp_ResponseCode != &quot;00&quot;]]" style="shape=line;dashed=1;whiteSpace=wrap;verticalAlign=top;labelPosition=center;verticalLabelPosition=middle;align=center;strokeColor=#B3B3B3;" vertex="1" parent="5gRXiJy-M-2pyrHTuUi6-40">
          <mxGeometry y="2685" width="3312" height="3" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-43" value="fillBookingForm()" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-7" target="5gRXiJy-M-2pyrHTuUi6-9">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="293" y="1453" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-44" value="validateInput()" style="curved=1;endArrow=block;rounded=0;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-9" target="5gRXiJy-M-2pyrHTuUi6-9">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="492" y="1507" />
              <mxPoint x="492" y="1537" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-45" value="showBookingPreview()" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-9" target="5gRXiJy-M-2pyrHTuUi6-7">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="296" y="1713" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-46" value="confirmBooking()" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-7" target="5gRXiJy-M-2pyrHTuUi6-10">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="293" y="1767" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-47" value="POST /api/vnpay/create-payment" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-10" target="5gRXiJy-M-2pyrHTuUi6-16">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="824" y="1821" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-48" value="createTransaction(vnpay, data)" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-16" target="5gRXiJy-M-2pyrHTuUi6-20">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1458" y="1997" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-49" value="INSERT Transaction" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-20" target="5gRXiJy-M-2pyrHTuUi6-27">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2005" y="2051" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-50" value="transactionId" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-26" target="5gRXiJy-M-2pyrHTuUi6-20">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2008" y="2105" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-51" value="Transaction" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-19" target="5gRXiJy-M-2pyrHTuUi6-16">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1461" y="2299" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-52" value="buildPaymentUrl()" style="curved=1;endArrow=block;rounded=0;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-16" target="5gRXiJy-M-2pyrHTuUi6-16">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1248" y="2353" />
              <mxPoint x="1248" y="2383" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-53" value="{paymentUrl, transactionRef, transactionId}" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-16" target="5gRXiJy-M-2pyrHTuUi6-10">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="827" y="2559" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-54" value="redirect(paymentUrl)" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-10" target="5gRXiJy-M-2pyrHTuUi6-25">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1273" y="2613" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-55" value="displayPaymentPage()" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-25" target="5gRXiJy-M-2pyrHTuUi6-7">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1121" y="2667" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-56" value="enterPaymentInfo()" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-7" target="5gRXiJy-M-2pyrHTuUi6-24">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1118" y="2721" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-57" value="processPayment()" style="curved=1;endArrow=block;rounded=0;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-24" target="5gRXiJy-M-2pyrHTuUi6-24">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2143" y="2775" />
              <mxPoint x="2143" y="2805" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-58" value="GET /api/vnpay/return&#xa;[vnp_ResponseCode=00]" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-24" target="5gRXiJy-M-2pyrHTuUi6-17">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1652" y="2928" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-59" value="verifyReturnUrl()" style="curved=1;endArrow=block;rounded=0;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-17" target="5gRXiJy-M-2pyrHTuUi6-17">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1248" y="3122" />
              <mxPoint x="1248" y="3152" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-60" value="SELECT Transaction&#xa;WHERE transactionRef = vnp_TxnRef" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-17" target="5gRXiJy-M-2pyrHTuUi6-28">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1749" y="3228" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-61" value="Transaction" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-26" target="5gRXiJy-M-2pyrHTuUi6-17">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1752" y="3282" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-62" value="updateTransactionStatus(completed, data)" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-17" target="5gRXiJy-M-2pyrHTuUi6-21">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1458" y="3336" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-63" value="UPDATE Transaction&#xa;SET status = &quot;completed&quot;" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-21" target="5gRXiJy-M-2pyrHTuUi6-29">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2005" y="3412" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-64" value="OK" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-26" target="5gRXiJy-M-2pyrHTuUi6-21">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2008" y="3466" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-65" value="Transaction" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-19" target="5gRXiJy-M-2pyrHTuUi6-17">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1461" y="3642" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-66" value="redirect(clientUrl/payment/vnpay-return?success=true)" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-17" target="5gRXiJy-M-2pyrHTuUi6-24">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1649" y="3696" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-67" value="redirect" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-24" target="5gRXiJy-M-2pyrHTuUi6-11">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1274" y="3750" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-68" value="displayPaymentSuccess()" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-11" target="5gRXiJy-M-2pyrHTuUi6-7">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="296" y="3804" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-69" value="POST /api/appointments" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-11" target="5gRXiJy-M-2pyrHTuUi6-14">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="601" y="3858" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-70" value="SELECT Vehicle&#xa;WHERE _id = vehicleId AND customerId = userId" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-14" target="5gRXiJy-M-2pyrHTuUi6-30">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1526" y="4093" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-71" value="Vehicle" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-26" target="5gRXiJy-M-2pyrHTuUi6-14">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1529" y="4147" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-72" value="validateVehicleOwnership()" style="curved=1;endArrow=block;rounded=0;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-14" target="5gRXiJy-M-2pyrHTuUi6-14">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="802" y="4201" />
              <mxPoint x="802" y="4231" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-73" value="generateAppointmentNumber()" style="curved=1;endArrow=block;rounded=0;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-14" target="5gRXiJy-M-2pyrHTuUi6-14">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="802" y="4285" />
              <mxPoint x="802" y="4315" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-74" value="INSERT Appointment" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-14" target="5gRXiJy-M-2pyrHTuUi6-31">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1526" y="4436" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-75" value="appointmentId" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-26" target="5gRXiJy-M-2pyrHTuUi6-14">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1529" y="4704" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-76" value="updateTransactionAppointmentId(transactionRef, appointmentId)" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-14" target="5gRXiJy-M-2pyrHTuUi6-22">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1235" y="4758" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-77" value="UPDATE Transaction&#xa;SET appointmentId = appointmentId" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-22" target="5gRXiJy-M-2pyrHTuUi6-32">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2005" y="4834" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-78" value="OK" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-26" target="5gRXiJy-M-2pyrHTuUi6-22">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2008" y="4888" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-79" value="OK" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-19" target="5gRXiJy-M-2pyrHTuUi6-14">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1238" y="4942" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-80" value="sendAppointmentConfirmation(appointmentData, userData)" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-14" target="5gRXiJy-M-2pyrHTuUi6-37">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1806" y="5043" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-81" value="confirmationEmail" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-36" target="5gRXiJy-M-2pyrHTuUi6-7">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1501" y="5237" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-82" value="SELECT Appointment&#xa;WITH populate(vehicle)" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-14" target="5gRXiJy-M-2pyrHTuUi6-33">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1526" y="5323" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-83" value="PopulatedAppointment" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-26" target="5gRXiJy-M-2pyrHTuUi6-14">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1529" y="5377" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-84" value="{success: true, data: Appointment}" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-13" target="5gRXiJy-M-2pyrHTuUi6-11">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="604" y="5431" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-85" value="showAppointmentConfirmation()" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-11" target="5gRXiJy-M-2pyrHTuUi6-7">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="296" y="5485" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-86" value="GET /api/vnpay/return&#xa;[vnp_ResponseCode != &quot;00&quot;]" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-24" target="5gRXiJy-M-2pyrHTuUi6-18">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1652" y="5608" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-87" value="verifyReturnUrl()" style="curved=1;endArrow=block;rounded=0;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-18" target="5gRXiJy-M-2pyrHTuUi6-18">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1248" y="5662" />
              <mxPoint x="1248" y="5692" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-88" value="SELECT Transaction" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-18" target="5gRXiJy-M-2pyrHTuUi6-34">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1749" y="5746" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-89" value="Transaction" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-26" target="5gRXiJy-M-2pyrHTuUi6-18">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1752" y="5800" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-90" value="updateTransactionStatus(failed, data)" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-18" target="5gRXiJy-M-2pyrHTuUi6-23">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1458" y="5854" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-91" value="UPDATE Transaction&#xa;SET status = &quot;failed&quot;" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-23" target="5gRXiJy-M-2pyrHTuUi6-35">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2005" y="5930" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-92" value="OK" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-26" target="5gRXiJy-M-2pyrHTuUi6-23">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2008" y="6088" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-93" value="Transaction" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-19" target="5gRXiJy-M-2pyrHTuUi6-18">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1461" y="6142" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-94" value="redirect(clientUrl/payment/vnpay-return?success=false&amp;error=...)" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-18" target="5gRXiJy-M-2pyrHTuUi6-24">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1649" y="6196" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-95" value="redirect" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-24" target="5gRXiJy-M-2pyrHTuUi6-12">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1274" y="6250" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-96" value="displayPaymentFailed()" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;" edge="1" parent="1" source="5gRXiJy-M-2pyrHTuUi6-12" target="5gRXiJy-M-2pyrHTuUi6-7">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="296" y="6304" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-97" value="Use Case: Customer đặt cọc 200,000 VND để book lịch hẹn (không chọn dịch vụ)&#xa;Pre-condition: Customer đã đăng nhập, có xe trong hệ thống&#xa;Post-condition: Appointment được tạo với status &quot;confirmed&quot;, cọc đã thanh toán&#xa;Note: Dịch vụ cụ thể sẽ xác định sau khi technician kiểm tra xe" style="fillColor=#ffff88;strokeColor=#9E916F;" vertex="1" parent="1">
          <mxGeometry x="110" y="1315" width="2763" height="104" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-98" value="Validate:&#xa;- vehicleId exists&#xa;- scheduledDate valid&#xa;- scheduledTime available&#xa;- bookingType: &quot;deposit_booking&quot;" style="fillColor=#ffff88;strokeColor=#9E916F;" vertex="1" parent="1">
          <mxGeometry x="462" y="1557" width="260" height="122" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-99" value="Request body:&#xa;- amount: 200000&#xa;- orderInfo: &quot;Thanh toan dat coc xe dien&quot;&#xa;- paymentType: &quot;deposit&quot;&#xa;- appointmentData: {vehicleId, scheduledDate, scheduledTime}" style="fillColor=#ffff88;strokeColor=#9E916F;" vertex="1" parent="1">
          <mxGeometry x="1218" y="1841" width="462" height="122" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-100" value="Transaction:&#xa;- transactionRef: APP{timestamp}{random}&#xa;- status: &quot;pending&quot;&#xa;- paymentPurpose: &quot;deposit_booking&quot;&#xa;- amount: 200000&#xa;- metadata: {appointmentData}" style="fillColor=#ffff88;strokeColor=#9E916F;" vertex="1" parent="1">
          <mxGeometry x="1730" y="2125" width="317" height="140" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-101" value="VNPay params:&#xa;- vnp_TxnRef&#xa;- vnp_Amount: 20000000 (VND * 100)&#xa;- vnp_ReturnUrl&#xa;- vnp_SecureHash" style="fillColor=#ffff88;strokeColor=#9E916F;" vertex="1" parent="1">
          <mxGeometry x="1218" y="2403" width="286" height="122" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-102" value="Callback params:&#xa;- vnp_TxnRef&#xa;- vnp_ResponseCode: &quot;00&quot;&#xa;- vnp_TransactionNo&#xa;- vnp_Amount&#xa;- vnp_SecureHash" style="fillColor=#ffff88;strokeColor=#9E916F;" vertex="1" parent="1">
          <mxGeometry x="1218" y="2948" width="206" height="140" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-103" value="Update:&#xa;- status: &quot;completed&quot;&#xa;- responseCode: &quot;00&quot;&#xa;- paidAmount: 200000&#xa;- vnpayData: {bankCode, cardType, payDate}" style="fillColor=#ffff88;strokeColor=#9E916F;" vertex="1" parent="1">
          <mxGeometry x="1730" y="3486" width="333" height="122" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-104" value="Request body:&#xa;- vehicleId&#xa;- bookingType: &quot;deposit_booking&quot;&#xa;- services: [] (empty)&#xa;- scheduledDate, scheduledTime&#xa;- customerNotes (optional)&#xa;- paymentInfo: {transactionRef}" style="fillColor=#ffff88;strokeColor=#9E916F;" vertex="1" parent="1">
          <mxGeometry x="772" y="3878" width="260" height="159" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-105" value="appointmentNumber: APT{YYMMDD}{random3digits}&#xa;Example: APT250106234" style="fillColor=#ffff88;strokeColor=#9E916F;" vertex="1" parent="1">
          <mxGeometry x="772" y="4335" width="396" height="67" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-106" value="Appointment:&#xa;- appointmentNumber: APT250106234&#xa;- customerId&#xa;- vehicleId&#xa;- services: [] (empty)&#xa;- bookingType: &quot;deposit_booking&quot;&#xa;- depositInfo: {amount: 200000, paid: true, paidAt: now, transactionId}&#xa;- status: &quot;confirmed&quot;&#xa;- scheduledDate, scheduledTime&#xa;- customerNotes (optional)" style="fillColor=#ffff88;strokeColor=#9E916F;" vertex="1" parent="1">
          <mxGeometry x="2313" y="4456" width="510" height="214" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-107" value="Email content:&#xa;- Appointment number: APT250106234&#xa;- Scheduled date &amp; time&#xa;- Service center info&#xa;- Deposit paid: 200,000 VND&#xa;- Note: Dịch vụ cụ thể sẽ xác định sau khi technician kiểm tra xe" style="fillColor=#ffff88;strokeColor=#9E916F;" vertex="1" parent="1">
          <mxGeometry x="2873" y="5063" width="469" height="140" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-108" value="Update:&#xa;- status: &quot;failed&quot;&#xa;- errorCode: vnp_ResponseCode&#xa;- errorMessage: &quot;Payment failed&quot;" style="fillColor=#ffff88;strokeColor=#9E916F;" vertex="1" parent="1">
          <mxGeometry x="2313" y="5950" width="252" height="104" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-109" value="Customer có thể:&#xa;- Retry payment&#xa;- Cancel booking&#xa;- Contact support" style="fillColor=#ffff88;strokeColor=#9E916F;" vertex="1" parent="1">
          <mxGeometry x="60" y="6324" width="150" height="104" as="geometry" />
        </mxCell>
        <mxCell id="5gRXiJy-M-2pyrHTuUi6-110" value="&lt;b&gt;Business Rules:&lt;/b&gt;&#xa;1. Deposit amount cố định: 200,000 VND&#xa;2. Appointment auto-confirmed sau khi thanh toán thành công&#xa;3. Transaction lifecycle: pending → completed/failed&#xa;4. Deposit Booking: services[] = empty, xác định sau khi kiểm tra xe&#xa;5. Customer chỉ chọn ngày/giờ và xe, không chọn dịch vụ&#xa;&#xa;&lt;b&gt;Technical Details:&lt;/b&gt;&#xa;- VNPay amount: VND * 100 (20,000,000 = 200k VND)&#xa;- Transaction ref format: APP{timestamp}{random9chars}&#xa;- Appointment number format: APT{YYMMDD}{random3digits}&#xa;- Payment timeout: 15 minutes&#xa;- bookingType: &quot;deposit_booking&quot; (services empty)&#xa;&#xa;&lt;b&gt;Security:&lt;/b&gt;&#xa;- VNPay secure hash verification&#xa;- Vehicle ownership validation&#xa;- JWT authentication for all API calls&#xa;&#xa;&lt;b&gt;Next Steps:&lt;/b&gt;&#xa;Sau khi customer đến service center:&#xa;1. Technician kiểm tra xe (EV diagnostics)&#xa;2. Tạo ServiceReception với recommended services&#xa;3. Staff duyệt services và parts&#xa;4. Customer đồng ý → Proceed to service" style="fillColor=#ffff88;strokeColor=#9E916F;" vertex="1" parent="1">
          <mxGeometry x="110" y="6438" width="2763" height="490" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
