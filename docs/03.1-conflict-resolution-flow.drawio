<mxfile host="Electron" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/28.0.4 Chrome/138.0.7204.97 Electron/37.2.1 Safari/537.36" version="28.0.4">
  <diagram name="Part Conflict Resolution Flow" id="conflict-resolution-diagram">
    <mxGraphModel dx="1204" dy="759" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="2400" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="Part Conflict Resolution Flow&#xa;EV Service Center Management System" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="400" y="20" width="800" height="40" as="geometry" />
        </mxCell>
        <mxCell id="staff-box" value="Staff" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;outlineConnect=0;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="80" y="100" width="40" height="80" as="geometry" />
        </mxCell>
        <mxCell id="staff-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;strokeColor=#666666;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="100" y="2300" as="sourcePoint" />
            <mxPoint x="100" y="180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ui-box" value="ConflictPage" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="200" y="120" width="110" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ui-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;strokeColor=#666666;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="255" y="2300" as="sourcePoint" />
            <mxPoint x="255" y="160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conflict-svc-box" value="PartConflictService" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="400" y="120" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="conflict-svc-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;strokeColor=#666666;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="475" y="2300" as="sourcePoint" />
            <mxPoint x="475" y="160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="reception-svc-box" value="ServiceReceptionService" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="600" y="120" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="reception-svc-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;strokeColor=#666666;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="685" y="2300" as="sourcePoint" />
            <mxPoint x="685" y="160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="part-svc-box" value="PartService" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="820" y="120" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="part-svc-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;strokeColor=#666666;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="870" y="2300" as="sourcePoint" />
            <mxPoint x="870" y="160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="db-box" value="Database" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;" parent="1" vertex="1">
          <mxGeometry x="970" y="120" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="db-line" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;strokeColor=#666666;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1020" y="2300" as="sourcePoint" />
            <mxPoint x="1020" y="160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="usecase-note" value="Use Case: Staff resolves part conflicts when multiple service receptions request the same parts&#xa;Pre-condition: Conflict has been detected (hasConflict=true, conflictIds[] populated)&#xa;Post-condition: Conflict resolved - some requests approved, others rejected/deferred&#xa;Business Rule: Staff manually decides which requests to approve based on priority, scheduled date, and business needs" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;size=10;" parent="1" vertex="1">
          <mxGeometry x="80" y="220" width="990" height="80" as="geometry" />
        </mxCell>
        <mxCell id="trigger-note" value="TRIGGER: This flow starts AFTER diagram 03 completes and conflict is detected&#xa;Entry point: Staff notices hasConflict=true flag or system sends notification" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#d4edda;strokeColor=#009900;align=left;size=10;" vertex="1" parent="1">
          <mxGeometry x="80" y="320" width="990" height="50" as="geometry" />
        </mxCell>
        <mxCell id="msg1" value="navigateToConflictPage()" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;" parent="1" edge="1">
          <mxGeometry x="1" y="-30" relative="1" as="geometry">
            <mxPoint x="100" y="400" as="sourcePoint" />
            <mxPoint x="255" y="400" as="targetPoint" />
            <mxPoint x="-5" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ui-act1" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="250" y="400" width="10" height="120" as="geometry" />
        </mxCell>
        <mxCell id="msg2" value="GET /api/part-conflicts?status=pending" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;" parent="1" edge="1">
          <mxGeometry x="-0.6" y="20" relative="1" as="geometry">
            <mxPoint x="260" y="430" as="sourcePoint" />
            <mxPoint x="475" y="430" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conflict-svc-act1" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="470" y="430" width="10" height="60" as="geometry" />
        </mxCell>
        <mxCell id="msg3" value="conflictsList" style="endArrow=open;endFill=0;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry x="0.6" y="-20" relative="1" as="geometry">
            <mxPoint x="475" y="480" as="sourcePoint" />
            <mxPoint x="255" y="480" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg4" value="displayConflictsList()" style="endArrow=open;endFill=0;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry x="0.5" y="-20" relative="1" as="geometry">
            <mxPoint x="255" y="510" as="sourcePoint" />
            <mxPoint x="100" y="510" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="staff-act1" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="95" y="540" width="10" height="1700" as="geometry" />
        </mxCell>
        <mxCell id="msg5" value="selectConflict(conflictId)" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;" parent="1" edge="1">
          <mxGeometry x="1" y="-30" relative="1" as="geometry">
            <mxPoint x="105" y="570" as="sourcePoint" />
            <mxPoint x="255" y="570" as="targetPoint" />
            <mxPoint x="-5" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ui-act2" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="250" y="570" width="10" height="200" as="geometry" />
        </mxCell>
        <mxCell id="msg6" value="GET /api/part-conflicts/:id" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;" parent="1" edge="1">
          <mxGeometry x="-0.6" y="20" relative="1" as="geometry">
            <mxPoint x="260" y="600" as="sourcePoint" />
            <mxPoint x="475" y="600" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conflict-svc-act2" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="470" y="600" width="10" height="60" as="geometry" />
        </mxCell>
        <mxCell id="msg7" value="conflictDetails (with prioritized requests)" style="endArrow=open;endFill=0;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry x="0.6" y="-20" relative="1" as="geometry">
            <mxPoint x="475" y="650" as="sourcePoint" />
            <mxPoint x="255" y="650" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg8" value="GET /api/part-conflicts/:id/suggestion" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;strokeColor=#0066CC;" parent="1" edge="1">
          <mxGeometry x="-0.6" y="20" relative="1" as="geometry">
            <mxPoint x="260" y="690" as="sourcePoint" />
            <mxPoint x="475" y="690" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conflict-svc-act3" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="470" y="690" width="10" height="50" as="geometry" />
        </mxCell>
        <mxCell id="suggestion-note" value="Auto-suggestion based on:&#xa;1. Priority (urgent > high > normal > low)&#xa;2. Scheduled date (earlier first)&#xa;3. Available stock allocation" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#cfe2ff;strokeColor=#0066CC;align=left;size=8;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="540" y="680" width="200" height="70" as="geometry" />
        </mxCell>
        <mxCell id="msg9" value="suggestedResolution" style="endArrow=open;endFill=0;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;dashed=1;strokeColor=#0066CC;" parent="1" edge="1">
          <mxGeometry x="0.6" y="-20" relative="1" as="geometry">
            <mxPoint x="475" y="730" as="sourcePoint" />
            <mxPoint x="255" y="730" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg10" value="showConflictDetails()" style="endArrow=open;endFill=0;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry x="0.5" y="-20" relative="1" as="geometry">
            <mxPoint x="255" y="760" as="sourceSource" />
            <mxPoint x="100" y="760" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="decision-note" value="Staff reviews conflict details:&#xa;- Part info (name, available stock)&#xa;- All conflicting requests&#xa;- Priority and scheduled date&#xa;- Auto-suggested resolution&#xa;Then decides to approve/reject each request" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#fff4e6;strokeColor=#ff6600;align=left;size=8;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="110" y="770" width="240" height="100" as="geometry" />
        </mxCell>
        <mxCell id="alt-frame" value="alt [Resolution Method]" style="shape=rect;html=1;whiteSpace=wrap;align=left;verticalAlign=top;fillColor=none;strokeColor=#CC0000;strokeWidth=2;dashed=1;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="900" width="990" height="1300" as="geometry" />
        </mxCell>
        <mxCell id="alt-cond1" value="[Option 1: Approve Single Request]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=2;fontColor=#CC0000;" vertex="1" parent="1">
          <mxGeometry x="200" y="900" width="250" height="20" as="geometry" />
        </mxCell>
        <mxCell id="msg11" value="approveRequest(conflictId, requestId)" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;" parent="1" edge="1">
          <mxGeometry x="-1" y="21" relative="1" as="geometry">
            <mxPoint x="105" y="940" as="sourcePoint" />
            <mxPoint x="255" y="940" as="targetPoint" />
            <mxPoint x="-5" y="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ui-act3" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="250" y="940" width="10" height="200" as="geometry" />
        </mxCell>
        <mxCell id="msg12" value="POST /api/part-conflicts/:id/approve-request" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;" parent="1" edge="1">
          <mxGeometry x="-0.6" y="20" relative="1" as="geometry">
            <mxPoint x="260" y="970" as="sourcePoint" />
            <mxPoint x="475" y="970" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conflict-svc-act4" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="470" y="970" width="10" height="340" as="geometry" />
        </mxCell>
        <mxCell id="msg13" value="validateStock(partId, quantity)" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;" parent="1" edge="1">
          <mxGeometry x="-0.6" y="20" relative="1" as="geometry">
            <mxPoint x="480" y="1000" as="sourcePoint" />
            <mxPoint x="870" y="1000" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="part-svc-act1" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="865" y="1000" width="10" height="40" as="geometry" />
        </mxCell>
        <mxCell id="msg14" value="stockAvailable" style="endArrow=open;endFill=0;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry x="0.6" y="-20" relative="1" as="geometry">
            <mxPoint x="870" y="1030" as="sourcePoint" />
            <mxPoint x="475" y="1030" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg15" value="UPDATE ServiceReception SET requestedParts.isApproved=true" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;" parent="1" edge="1">
          <mxGeometry x="-0.7" y="20" relative="1" as="geometry">
            <mxPoint x="480" y="1060" as="sourcePoint" />
            <mxPoint x="685" y="1060" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="reception-svc-act1" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="680" y="1060" width="10" height="40" as="geometry" />
        </mxCell>
        <mxCell id="msg16" value="UPDATE ServiceReception SET staffReviewStatus=&#39;approved&#39;" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;" parent="1" edge="1">
          <mxGeometry x="-0.7" y="20" relative="1" as="geometry">
            <mxPoint x="480" y="1110" as="sourcePoint" />
            <mxPoint x="1020" y="1110" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="db-act1" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;" parent="1" vertex="1">
          <mxGeometry x="1015" y="1110" width="10" height="30" as="geometry" />
        </mxCell>
        <mxCell id="msg17" value="reserveParts(partId, quantity)" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;strokeColor=#009900;" parent="1" edge="1">
          <mxGeometry x="-0.6" y="20" relative="1" as="geometry">
            <mxPoint x="480" y="1150" as="sourcePoint" />
            <mxPoint x="870" y="1150" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="part-svc-act2" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="865" y="1150" width="10" height="60" as="geometry" />
        </mxCell>
        <mxCell id="reserve-note" value="Reserve parts:&#xa;currentStock -= qty&#xa;reservedStock += qty" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#d4edda;strokeColor=#009900;align=left;size=8;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="920" y="1140" width="140" height="60" as="geometry" />
        </mxCell>
        <mxCell id="msg18" value="UPDATE Part inventory" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;strokeColor=#009900;" parent="1" edge="1">
          <mxGeometry x="-0.7" y="20" relative="1" as="geometry">
            <mxPoint x="875" y="1190" as="sourcePoint" />
            <mxPoint x="1020" y="1190" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="db-act2" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;" parent="1" vertex="1">
          <mxGeometry x="1015" y="1190" width="10" height="30" as="geometry" />
        </mxCell>
        <mxCell id="msg19" value="UPDATE Appointment status=&#39;reception_approved&#39;" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;" parent="1" edge="1">
          <mxGeometry x="-0.7" y="20" relative="1" as="geometry">
            <mxPoint x="480" y="1230" as="sourcePoint" />
            <mxPoint x="1020" y="1230" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="db-act3" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;" parent="1" vertex="1">
          <mxGeometry x="1015" y="1230" width="10" height="30" as="geometry" />
        </mxCell>
        <mxCell id="msg20" value="UPDATE PartConflict request.status=&#39;approved&#39;" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;" parent="1" edge="1">
          <mxGeometry x="-0.7" y="20" relative="1" as="geometry">
            <mxPoint x="480" y="1270" as="sourcePoint" />
            <mxPoint x="1020" y="1270" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="db-act4" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;" parent="1" vertex="1">
          <mxGeometry x="1015" y="1270" width="10" height="30" as="geometry" />
        </mxCell>
        <mxCell id="msg21" value="approvalSuccess" style="endArrow=open;endFill=0;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry x="0.6" y="-20" relative="1" as="geometry">
            <mxPoint x="475" y="1300" as="sourcePoint" />
            <mxPoint x="255" y="1300" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg22" value="showApprovalSuccess()" style="endArrow=open;endFill=0;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry x="0.5" y="-20" relative="1" as="geometry">
            <mxPoint x="255" y="1130" as="sourcePoint" />
            <mxPoint x="100" y="1130" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="alt-divider1" value="" style="endArrow=none;html=1;strokeWidth=2;strokeColor=#CC0000;dashed=1;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="80" y="1350" as="sourcePoint" />
            <mxPoint x="1070" y="1350" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="alt-cond2" value="[Option 2: Reject Single Request]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=2;fontColor=#CC0000;" vertex="1" parent="1">
          <mxGeometry x="200" y="1350" width="250" height="20" as="geometry" />
        </mxCell>
        <mxCell id="msg23" value="rejectRequest(conflictId, requestId, reason)" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;" parent="1" edge="1">
          <mxGeometry x="-1" y="21" relative="1" as="geometry">
            <mxPoint x="105" y="1390" as="sourcePoint" />
            <mxPoint x="255" y="1390" as="targetPoint" />
            <mxPoint x="-5" y="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ui-act4" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="250" y="1390" width="10" height="140" as="geometry" />
        </mxCell>
        <mxCell id="msg24" value="POST /api/part-conflicts/:id/reject-request" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;" parent="1" edge="1">
          <mxGeometry x="-0.6" y="20" relative="1" as="geometry">
            <mxPoint x="260" y="1420" as="sourcePoint" />
            <mxPoint x="475" y="1420" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conflict-svc-act5" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="470" y="1420" width="10" height="180" as="geometry" />
        </mxCell>
        <mxCell id="msg25" value="UPDATE ServiceReception staffReviewStatus=&#39;pending_parts_restock&#39;" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;strokeColor=#CC0000;" parent="1" edge="1">
          <mxGeometry x="-0.7" y="20" relative="1" as="geometry">
            <mxPoint x="480" y="1450" as="sourcePoint" />
            <mxPoint x="685" y="1450" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="reception-svc-act2" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="680" y="1450" width="10" height="40" as="geometry" />
        </mxCell>
        <mxCell id="msg26" value="UPDATE Appointment status=&#39;parts_insufficient&#39; OR &#39;waiting_for_parts&#39;" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;strokeColor=#CC0000;" parent="1" edge="1">
          <mxGeometry x="-0.7" y="20" relative="1" as="geometry">
            <mxPoint x="480" y="1500" as="sourcePoint" />
            <mxPoint x="1020" y="1500" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="db-act5" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;" parent="1" vertex="1">
          <mxGeometry x="1015" y="1500" width="10" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rejection-note" value="Appointment status depends on reason:&#xa;- Stock issue → parts_insufficient&#xa;- Waiting for restock → waiting_for_parts" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#f8d7da;strokeColor=#CC0000;align=left;size=8;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="750" y="1480" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="msg27" value="UPDATE PartConflict request.status=&#39;rejected&#39;" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;strokeColor=#CC0000;" parent="1" edge="1">
          <mxGeometry x="-0.7" y="20" relative="1" as="geometry">
            <mxPoint x="480" y="1550" as="sourcePoint" />
            <mxPoint x="1020" y="1550" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="db-act6" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;" parent="1" vertex="1">
          <mxGeometry x="1015" y="1550" width="10" height="30" as="geometry" />
        </mxCell>
        <mxCell id="msg28" value="rejectionSuccess" style="endArrow=open;endFill=0;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;dashed=1;strokeColor=#CC0000;" parent="1" edge="1">
          <mxGeometry x="0.6" y="-20" relative="1" as="geometry">
            <mxPoint x="475" y="1590" as="sourcePoint" />
            <mxPoint x="255" y="1590" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg29" value="showRejectionReason()" style="endArrow=open;endFill=0;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry x="0.5" y="-20" relative="1" as="geometry">
            <mxPoint x="255" y="1520" as="sourcePoint" />
            <mxPoint x="100" y="1520" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="alt-divider2" value="" style="endArrow=none;html=1;strokeWidth=2;strokeColor=#CC0000;dashed=1;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="80" y="1640" as="sourcePoint" />
            <mxPoint x="1070" y="1640" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="alt-cond3" value="[Option 3: Batch Resolve (approve some, reject others)]" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=2;fontColor=#CC0000;" vertex="1" parent="1">
          <mxGeometry x="200" y="1640" width="370" height="20" as="geometry" />
        </mxCell>
        <mxCell id="msg30" value="batchResolve(conflictId, approvedIds[], rejectedIds[])" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;" parent="1" edge="1">
          <mxGeometry x="-1" y="21" relative="1" as="geometry">
            <mxPoint x="105" y="1680" as="sourcePoint" />
            <mxPoint x="255" y="1680" as="targetPoint" />
            <mxPoint x="-5" y="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ui-act5" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="250" y="1680" width="10" height="160" as="geometry" />
        </mxCell>
        <mxCell id="msg31" value="POST /api/part-conflicts/:id/resolve" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;" parent="1" edge="1">
          <mxGeometry x="-0.6" y="20" relative="1" as="geometry">
            <mxPoint x="260" y="1710" as="sourcePoint" />
            <mxPoint x="475" y="1710" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conflict-svc-act6" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="470" y="1710" width="10" height="200" as="geometry" />
        </mxCell>
        <mxCell id="msg32" value="Loop: Process each approved request (reserve parts, update status)" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;strokeColor=#009900;" parent="1" edge="1">
          <mxGeometry x="-0.3" y="10" relative="1" as="geometry">
            <mxPoint x="480" y="1750" as="sourcePoint" />
            <mxPoint x="480" y="1770" as="targetPoint" />
            <Array as="points">
              <mxPoint x="515" y="1750" />
              <mxPoint x="515" y="1770" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg33" value="Loop: Process each rejected request (update status)" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;strokeColor=#CC0000;" parent="1" edge="1">
          <mxGeometry x="-0.3" y="10" relative="1" as="geometry">
            <mxPoint x="480" y="1810" as="sourcePoint" />
            <mxPoint x="480" y="1830" as="targetPoint" />
            <Array as="points">
              <mxPoint x="515" y="1810" />
              <mxPoint x="515" y="1830" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg34" value="UPDATE PartConflict status=&#39;resolved&#39;" style="endArrow=block;endFill=1;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;" parent="1" edge="1">
          <mxGeometry x="-0.7" y="20" relative="1" as="geometry">
            <mxPoint x="480" y="1860" as="sourcePoint" />
            <mxPoint x="1020" y="1860" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="db-act7" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;" parent="1" vertex="1">
          <mxGeometry x="1015" y="1860" width="10" height="30" as="geometry" />
        </mxCell>
        <mxCell id="msg35" value="resolutionSummary" style="endArrow=open;endFill=0;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry x="0.6" y="-20" relative="1" as="geometry">
            <mxPoint x="475" y="1900" as="sourcePoint" />
            <mxPoint x="255" y="1900" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="msg36" value="showResolutionSummary()" style="endArrow=open;endFill=0;html=1;edgeStyle=orthogonalEdgeStyle;align=left;verticalAlign=top;strokeWidth=2;dashed=1;" parent="1" edge="1">
          <mxGeometry x="0.5" y="-20" relative="1" as="geometry">
            <mxPoint x="255" y="1830" as="sourcePoint" />
            <mxPoint x="100" y="1830" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="notification-note" value="Post-Resolution Actions:&#xa;1. Send notifications to customers (approved/rejected)&#xa;2. Send notifications to technicians&#xa;3. Update dashboard for affected appointments&#xa;4. Log resolution in conflict history" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#fff3cd;strokeColor=#ffc107;align=left;size=10;" vertex="1" parent="1">
          <mxGeometry x="80" y="1960" width="990" height="80" as="geometry" />
        </mxCell>
        <mxCell id="business-rules" value="Business Rules (Conflict Resolution):&#xa;1. Conflict statuses: pending → resolved (all requests handled)&#xa;2. Request statuses within conflict: pending → (approved OR rejected OR deferred)&#xa;3. Approval requirements:&#xa;   - Sufficient stock available (currentStock - reservedStock >= requestedQuantity)&#xa;   - Staff manually approves (no auto-approval for conflicted parts)&#xa;4. When request approved:&#xa;   - Reserve parts: currentStock -= qty, reservedStock += qty&#xa;   - Update ServiceReception.requestedParts[].isApproved = true&#xa;   - Update ServiceReception.staffReviewStatus = 'approved'&#xa;   - Update Appointment.status = 'reception_approved'&#xa;   - Update PartConflict.conflictingRequests[].status = 'approved'&#xa;5. When request rejected:&#xa;   - Update ServiceReception.staffReviewStatus = 'pending_parts_restock'&#xa;   - Update Appointment.status = 'parts_insufficient' OR 'waiting_for_parts'&#xa;   - Update PartConflict.conflictingRequests[].status = 'rejected'&#xa;   - Reason required for rejection&#xa;6. Priority-based suggestion:&#xa;   - System suggests approval order based on: priority > scheduled date > FIFO&#xa;   - Staff can override suggestion (manual decision)&#xa;7. Conflict marked 'resolved' when ALL requests have non-pending status&#xa;8. Staff can resolve conflicts individually (one request at a time) or in batch&#xa;9. Notifications sent to customers and technicians after resolution" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffe6cc;strokeColor=#d79b00;align=left;size=10;" vertex="1" parent="1">
          <mxGeometry x="80" y="2070" width="990" height="340" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
